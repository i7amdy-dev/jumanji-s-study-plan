<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ramadan Study Timetable</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;0,700;1,400&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">

<style>
:root {
  --bg: #07060f;
  --surface: #100f1e;
  --card: #141229;
  --border: rgba(201,170,80,.15);
  --border-bright: rgba(201,170,80,.35);
  --gold: #c9aa50;
  --gold2: #f0d87a;
  --gold-dim: rgba(201,170,80,.08);
  --text: #ece8f5;
  --muted: #6a6490;
  --muted2: #9490b8;

  /* subject colors */
  --chem-off: #e07840;
  --chem-on:  #3ecf8a;
  --phys-on:  #5aabf0;
  --math:     #b06ff0;
  --arabic:   #f07090;
  --english:  #70d0e0;
  --iftar:    #f0c030;
  --rest:     #4a8a5a;
  --sleep:    #2a2840;
  --hw:       #d4607a;

  --r: 12px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BASE / RESET
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
*{box-sizing:border-box;margin:0;padding:0}
html { -webkit-text-size-adjust:100%; }
body {
  background: var(--bg);
  color: var(--text);
  font-family: 'DM Sans', sans-serif;
  min-height: 100vh;
  overflow-x: hidden;
  /* space for mobile bottom nav */
  padding-bottom: env(safe-area-inset-bottom, 0);
}

/* â”€â”€ Background atmosphere â”€â”€ */
body::before {
  content:'';
  position:fixed;inset:0;
  background:
    radial-gradient(ellipse 60% 40% at 20% 10%, rgba(201,170,80,.06) 0%, transparent 60%),
    radial-gradient(ellipse 50% 50% at 80% 80%, rgba(90,100,180,.07) 0%, transparent 60%);
  pointer-events:none;z-index:0;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LAYOUT WRAPPER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.wrap {
  max-width: 1200px;
  margin: auto;
  padding: 12px 12px 80px; /* bottom space for mobile nav */
  position: relative;
  z-index: 1;
}
@media(min-width:820px){ .wrap { padding: 20px 20px 24px; } }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HEADER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
header {
  text-align: center;
  padding: 14px 0 16px;
}
.header-arabic {
  font-size: .72rem;
  letter-spacing: .2em;
  color: var(--gold);
  opacity: .7;
  margin-bottom: 5px;
}
header h1 {
  font-family: 'Cormorant Garamond', serif;
  font-size: clamp(1.4rem, 5vw, 2.8rem);
  font-weight: 600;
  color: var(--gold2);
  letter-spacing: .02em;
  line-height: 1.15;
}
.header-crescent {
  font-size: 1.1rem;
  margin: 0 6px;
  vertical-align: middle;
  opacity: .85;
}
.header-meta {
  font-size: .68rem;
  color: var(--muted2);
  margin-top: 5px;
  letter-spacing: .08em;
}
.header-line {
  width: 90px; height: 1px;
  background: linear-gradient(90deg, transparent, var(--gold), transparent);
  margin: 10px auto 0;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PROGRESS TRACKLINE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.trackline-wrap {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--r);
  padding: 12px 14px 12px;
  margin-bottom: 12px;
}
@media(min-width:820px){ .trackline-wrap { padding: 16px 20px 14px; } }

.trackline-top {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
  flex-wrap: wrap;
  gap: 6px;
}
.trackline-left { display:flex;align-items:center;gap:8px;flex-wrap:wrap; }
.tl-label {
  font-size: .58rem;
  font-weight: 600;
  letter-spacing: .14em;
  color: var(--gold);
}
.tl-day-badge {
  font-size: .62rem;
  padding: 2px 8px;
  border-radius: 12px;
  background: var(--gold-dim);
  border: 1px solid rgba(201,170,80,.25);
  color: var(--gold2);
  font-weight: 600;
}
.trackline-right { display:flex;align-items:center;gap:8px; }
.tl-pct {
  font-family: 'Cormorant Garamond', serif;
  font-size: 1.2rem;
  font-weight: 600;
  color: var(--gold2);
}
.tl-days-left { font-size: .62rem; color: var(--muted2); }

.tl-bar-outer {
  position: relative;
  height: 10px;
  background: rgba(255,255,255,.06);
  border-radius: 10px;
  overflow: visible;
  margin-bottom: 4px;
}
.tl-bar-fill {
  height: 100%;
  border-radius: 10px;
  background: linear-gradient(90deg, #9a6a10, var(--gold), var(--gold2));
  transition: width .8s cubic-bezier(.4,0,.2,1);
  position: relative;
  min-width: 0;
}
.tl-bar-fill::after {
  content: '';
  position: absolute;
  right: -1px; top: -2px;
  width: 14px; height: 14px;
  border-radius: 50%;
  background: var(--gold2);
  box-shadow: 0 0 8px var(--gold);
  border: 2px solid var(--card);
}
.tl-ticks { position:absolute;inset:0;pointer-events:none; }
.tl-tick {
  position: absolute;
  top: -3px;
  width: 2px; height: 16px;
  background: rgba(255,255,255,.12);
  border-radius: 1px;
}
.tl-week-labels {
  display: flex;
  justify-content: space-between;
  margin-top: 5px;
  padding: 0 2px;
}
.tl-wlabel {
  font-size: .52rem;
  color: var(--muted);
  cursor: pointer;
  transition: color .15s;
  white-space: nowrap;
}
@media(max-width:480px){ .tl-wlabel { font-size: .46rem; } }
.tl-wlabel:hover,.tl-wlabel.on { color: var(--gold2); }

.tl-subjects {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 7px;
  margin-top: 12px;
}
@media(max-width:700px){ .tl-subjects { grid-template-columns: repeat(3, 1fr); } }
@media(max-width:400px){ .tl-subjects { grid-template-columns: repeat(2, 1fr) 1fr; } }

.tl-subj {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 9px;
  padding: 8px 9px;
  cursor: pointer;
  transition: all .15s;
  user-select: none;
  -webkit-tap-highlight-color: transparent;
}
.tl-subj:active { transform: scale(.97); }
.tl-subj:hover { border-color: var(--border-bright); }
.tl-subj-head {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 5px;
}
.tl-subj-name { font-size: .63rem; font-weight: 500; }
.tl-subj-pct { font-size: .58rem; color: var(--muted2); }
.tl-subj-bar-outer { height:4px;background:rgba(255,255,255,.07);border-radius:4px;overflow:hidden; }
.tl-subj-bar-fill { height:100%;border-radius:4px;transition:width .5s; }
.tl-subj-count {
  font-size: .56rem;
  color: var(--muted);
  margin-top: 4px;
  display: flex;
  justify-content: space-between;
}
.tl-subj-done { color: var(--gold); }

.tl-footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-top: 10px;
  flex-wrap: wrap;
  gap: 6px;
}
.tl-terms-btn {
  font-size: .63rem;
  padding: 6px 12px;
  border-radius: 16px;
  border: 1px solid rgba(201,170,80,.3);
  background: var(--gold-dim);
  color: var(--gold2);
  cursor: pointer;
  font-family: inherit;
  transition: all .15s;
  min-height: 36px;
  -webkit-tap-highlight-color: transparent;
}
.tl-terms-btn:hover { background: rgba(201,170,80,.15); border-color: var(--gold); }
.tl-footer-note { font-size: .56rem; color: var(--muted); }
@media(max-width:480px){ .tl-footer-note { display:none; } }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SHELL â€” SIDEBAR + MAIN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.shell {
  display: grid;
  grid-template-columns: 270px 1fr;
  gap: 14px;
  align-items: start;
}
/* mobile: sidebar goes below, main first */
@media(max-width:820px){
  .shell {
    grid-template-columns: 1fr;
  }
  .sidebar { order: 2; }
  .main    { order: 1; }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SIDEBAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.sidebar {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--r);
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 14px;
  position: sticky;
  top: 12px;
}
@media(max-width:820px){
  .sidebar {
    position: static;
  }
  /* collapsed by default on mobile */
  .sidebar-content { display: none; }
  .sidebar-content.open { display: flex; flex-direction: column; gap: 14px; }
}
/* always visible on desktop */
@media(min-width:821px){
  .sidebar-content { display: flex; flex-direction: column; gap: 14px; }
  .sidebar-toggle  { display: none !important; }
}

/* sidebar toggle button â€” mobile only */
.sidebar-toggle {
  display: none;
  width: 100%;
  background: none;
  border: none;
  color: var(--gold2);
  font-family: inherit;
  font-size: .8rem;
  font-weight: 500;
  cursor: pointer;
  padding: 4px 0;
  text-align: left;
  justify-content: space-between;
  align-items: center;
  -webkit-tap-highlight-color: transparent;
}
.sidebar-toggle-icon { font-size: 1rem; transition: transform .2s; }
.sidebar-toggle.open .sidebar-toggle-icon { transform: rotate(180deg); }
@media(max-width:820px){ .sidebar-toggle { display: flex; } }

.sb-block-title {
  font-size: .62rem;
  font-weight: 600;
  letter-spacing: .14em;
  text-transform: uppercase;
  color: var(--gold);
  margin-bottom: 8px;
}

/* subjects */
.subject-list { display:flex;flex-direction:column;gap:6px; }
.subj { display:flex;align-items:center;gap:8px;font-size:.76rem; }
.subj-dot { width:9px;height:9px;border-radius:50%;flex-shrink:0; }
.subj-name { flex:1; }
.subj-badge {
  font-size: .58rem;
  padding: 2px 7px;
  border-radius: 10px;
  background: var(--gold-dim);
  color: var(--gold);
  border: 1px solid rgba(201,170,80,.2);
  white-space: nowrap;
}

/* week plan */
.week-plan { display:flex;flex-direction:column;gap:5px; }
.wplan-row {
  background: var(--surface);
  border-radius: 8px;
  padding: 6px 10px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: .71rem;
}
.wplan-label { color: var(--muted2); }
.wplan-val { color: var(--text); }

/* tracker */
.tracker {
  background: linear-gradient(135deg, rgba(201,170,80,.07) 0%, rgba(62,207,138,.05) 100%);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 11px;
}
.tracker-rows { display:flex;flex-direction:column;gap:8px;margin-top:8px; }
.trow { font-size:.7rem; }
.trow-head { display:flex;justify-content:space-between;margin-bottom:3px; }
.trow-bar { height:5px;border-radius:3px;background:rgba(255,255,255,.07); }
.trow-fill { height:100%;border-radius:3px;transition:width .6s; }
.tracker-note { font-size:.6rem;color:var(--muted);margin-top:8px;line-height:1.5; }

/* legend */
.legend { display:flex;flex-wrap:wrap;gap:7px; }
.leg { display:flex;align-items:center;gap:5px;font-size:.63rem;color:var(--muted2); }
.leg-dot { width:8px;height:8px;border-radius:50%;flex-shrink:0; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MAIN PANEL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.main {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--r);
  padding: 14px;
  min-width: 0;
}
@media(min-width:820px){ .main { padding: 18px; } }

/* view toggle */
.vtoggle {
  display: inline-flex;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 30px;
  padding: 3px;
  gap: 2px;
  margin-bottom: 14px;
}
.vt {
  padding: 8px 18px;
  border: none;
  background: none;
  color: var(--muted2);
  cursor: pointer;
  border-radius: 26px;
  font-size: .78rem;
  font-family: inherit;
  transition: all .2s;
  min-height: 38px;
  -webkit-tap-highlight-color: transparent;
}
.vt.on {
  background: linear-gradient(135deg, #9a7a18, var(--gold));
  color: #000;
  font-weight: 600;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   WEEK VIEW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#week-view { display:none; }
#week-view.active { display:block; }

.week-header {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  margin-bottom: 12px;
  flex-wrap: wrap;
  gap: 8px;
}
.week-header-title {
  font-family: 'Cormorant Garamond', serif;
  font-size: 1.1rem;
  color: var(--gold2);
}
.week-header-meta { font-size: .68rem; color: var(--muted2); margin-top: 1px; }
.week-counter { display:flex;gap:5px;flex-wrap:wrap; }
.wk-pill {
  font-size: .62rem;
  padding: 5px 10px;
  border-radius: 20px;
  border: 1px solid var(--border);
  color: var(--muted2);
  background: var(--surface);
  cursor: pointer;
  transition: all .15s;
  min-height: 30px;
  -webkit-tap-highlight-color: transparent;
}
.wk-pill.on { border-color:var(--gold);color:var(--gold2);background:var(--gold-dim); }

/* week grid â€” 7 cols on desktop, scroll on mobile */
.week-grid-scroll {
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
  padding-bottom: 6px;
  scrollbar-width: thin;
  scrollbar-color: var(--border) transparent;
}
.week-grid-scroll::-webkit-scrollbar { height: 4px; }
.week-grid-scroll::-webkit-scrollbar-thumb { background: var(--border); border-radius: 2px; }

.week-grid {
  display: grid;
  grid-template-columns: repeat(7, minmax(150px, 1fr));
  gap: 10px;
  min-width: 700px;      /* forces scroll on small screens */
}
@media(min-width:1100px){
  .week-grid { grid-template-columns: repeat(7, 1fr); min-width: unset; }
}

.wday {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 13px 11px;
  cursor: pointer;
  transition: all .2s;
  display: flex;
  flex-direction: column;
  -webkit-tap-highlight-color: transparent;
}
.wday:hover { border-color:var(--border-bright);transform:translateY(-2px);box-shadow:0 8px 24px rgba(0,0,0,.35); }
.wday:active { transform: scale(.98); }
.wday.today { border-color:var(--gold);box-shadow:0 0 0 1px var(--gold),0 4px 16px rgba(201,170,80,.15); }

.wday-header { display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:8px; }
.wday-name { font-size:.72rem;font-weight:600;letter-spacing:.05em;text-transform:uppercase;color:var(--gold); }
.wday-today-badge { font-size:.52rem;padding:2px 6px;border-radius:8px;background:var(--gold);color:#000;font-weight:700; }
.wday-date { font-family:'Cormorant Garamond',serif;font-size:1.6rem;font-weight:600;color:var(--text);line-height:1;margin-bottom:2px; }
.wday-month { font-size:.58rem;color:var(--muted2);margin-bottom:3px;text-transform:uppercase;letter-spacing:.07em; }
.wday-day-num { font-size:.57rem;color:var(--muted);margin-bottom:9px; }
.wday-divider { height:1px;background:var(--border);margin-bottom:9px; }
.wday-type { font-size:.6rem;color:var(--muted2);margin-bottom:7px;line-height:1.4; }
.wday-slots { display:flex;flex-direction:column;gap:4px; }
.wslot { font-size:.6rem;padding:4px 7px;border-radius:5px;border-left:3px solid;background:rgba(255,255,255,.04);line-height:1.3; }
.wslot-time { font-size:.55rem;opacity:.6;margin-top:2px; }
.wday-total { margin-top:auto;padding-top:8px;border-top:1px solid var(--border);font-size:.58rem;color:var(--muted);display:flex;justify-content:space-between; }
.wday-total-hours { color:var(--gold);font-weight:500; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DAY VIEW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#day-view { display:none; }
#day-view.active { display:block; }

.day-nav {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 8px;
}
.nav-btn {
  width: 40px; height: 40px;
  border-radius: 50%;
  border: 1px solid var(--border);
  background: var(--surface);
  color: var(--gold2);
  font-size: 20px;
  cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  transition: all .15s;
  flex-shrink: 0;
  -webkit-tap-highlight-color: transparent;
}
.nav-btn:hover  { border-color:var(--gold);background:var(--gold-dim); }
.nav-btn:active { transform:scale(.9); }
.day-title-wrap { flex:1;min-width:0; }
.day-main-title {
  font-family: 'Cormorant Garamond', serif;
  font-size: clamp(1.3rem, 4vw, 1.8rem);
  font-weight: 600;
  color: var(--gold2);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.day-subtitle { font-size:.68rem;color:var(--muted2);margin-top:1px; }

.day-dots {
  display: flex;
  gap: 6px;
  justify-content: center;
  margin-bottom: 12px;
  flex-wrap: wrap;
}
.daydot {
  width: 9px; height: 9px;
  border-radius: 50%;
  background: var(--border);
  cursor: pointer;
  transition: all .15s;
  -webkit-tap-highlight-color: transparent;
}
.daydot.on { background:var(--gold);transform:scale(1.3); }

.export-btn {
  border: 1px solid var(--border);
  background: none;
  color: var(--muted2);
  padding: 7px 16px;
  border-radius: 20px;
  font-size: .7rem;
  cursor: pointer;
  font-family: inherit;
  transition: all .15s;
  margin-bottom: 14px;
  min-height: 36px;
  -webkit-tap-highlight-color: transparent;
}
.export-btn:hover { border-color:var(--gold);color:var(--gold2); }

/* timeline */
.timeline { display:flex;flex-direction:column;gap:0; }

.tblock {
  display: flex;
  gap: 0;
  animation: fadeSlide .3s ease both;
}
@keyframes fadeSlide {
  from { opacity:0;transform:translateY(8px); }
  to   { opacity:1;transform:translateY(0); }
}

.tblock-time-col {
  width: 58px;
  flex-shrink: 0;
  text-align: right;
  padding-right: 10px;
  padding-top: 14px;
  font-size: .58rem;
  color: var(--muted);
  line-height: 1.3;
}
@media(min-width:500px){ .tblock-time-col { width:68px;font-size:.62rem; } }

.tblock-connector {
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 18px;
  flex-shrink: 0;
}
.tblock-dot {
  width: 10px; height: 10px;
  border-radius: 50%;
  margin-top: 15px;
  flex-shrink: 0;
  border: 2px solid;
}
.tblock-line { width:2px;flex:1;background:var(--border);margin-top:2px; }
.tblock:last-child .tblock-line { display:none; }

.tblock-card {
  flex: 1;
  margin: 5px 0 5px 8px;
  padding: 10px 12px;
  border-radius: 10px;
  border-left: 3px solid;
  background: rgba(255,255,255,.03);
  transition: background .15s;
  min-width: 0;
}
.tblock-card:hover { background:rgba(255,255,255,.06); }
.tblock-card.hw-block { background:rgba(212,96,122,.04);border-left-style:dashed; }
.tblock-card.hw-block:hover { background:rgba(212,96,122,.08); }

.tbc-title { font-weight:500;font-size:.83rem;margin-bottom:3px;line-height:1.3; }
.tbc-time  { font-size:.65rem;color:var(--muted2); }
.tbc-desc  { font-size:.68rem;color:var(--muted);margin-top:5px;line-height:1.5; }
.tbc-tags  { display:flex;gap:4px;margin-top:6px;flex-wrap:wrap; }
.tbc-tag {
  font-size: .57rem;
  padding: 2px 7px;
  border-radius: 10px;
  background: var(--gold-dim);
  color: var(--muted2);
  border: 1px solid var(--border);
}
.empty-day { text-align:center;padding:40px 0;color:var(--muted);font-size:.8rem; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MOBILE BOTTOM NAV
   Replaces top view toggle on small screens
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.mobile-nav {
  display: none;
  position: fixed;
  bottom: 0; left: 0; right: 0;
  background: var(--card);
  border-top: 1px solid var(--border);
  z-index: 50;
  padding: 0 0 env(safe-area-inset-bottom, 0);
  backdrop-filter: blur(12px);
}
@media(max-width:540px){ .mobile-nav { display: flex; } }

.mnav-btn {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 3px;
  padding: 10px 4px 8px;
  border: none;
  background: none;
  color: var(--muted);
  font-family: inherit;
  font-size: .58rem;
  cursor: pointer;
  transition: color .15s;
  -webkit-tap-highlight-color: transparent;
}
.mnav-btn.on { color: var(--gold2); }
.mnav-icon { font-size: 1.2rem; line-height: 1; }

/* hide top vtoggle on mobile */
@media(max-width:540px){ .vtoggle { display: none; } }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TERMS MODAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.modal-backdrop {
  display: none;
  position: fixed; inset: 0;
  background: rgba(0,0,0,.75);
  z-index: 100;
  backdrop-filter: blur(4px);
}
.modal-backdrop.open { display: block; }

.modal {
  display: none;
  position: fixed;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%) scale(.96);
  z-index: 101;
  width: min(680px, 96vw);
  max-height: 88vh;
  background: var(--card);
  border: 1px solid var(--border-bright);
  border-radius: 16px;
  overflow: hidden;
  flex-direction: column;
  transition: transform .2s, opacity .2s;
  opacity: 0;
}
/* mobile: full-screen sheet */
@media(max-width:540px){
  .modal {
    top: auto; bottom: 0; left: 0; right: 0;
    transform: translateY(10px);
    width: 100%;
    max-height: 92vh;
    border-bottom-left-radius: 0;
    border-bottom-right-radius: 0;
  }
  .modal.open { transform: translateY(0); }
}
.modal.open {
  display: flex;
  transform: translate(-50%, -50%) scale(1);
  opacity: 1;
}
@media(max-width:540px){
  .modal.open { transform: translateY(0); }
}

.modal-header {
  padding: 16px 18px 12px;
  border-bottom: 1px solid var(--border);
  display: flex;
  align-items: center;
  gap: 10px;
  flex-shrink: 0;
}
.modal-title-ar { font-size:.7rem;color:var(--gold);opacity:.7;letter-spacing:.1em; }
.modal-title { font-family:'Cormorant Garamond',serif;font-size:1.2rem;font-weight:600;color:var(--gold2);flex:1; }
.modal-close {
  width:32px;height:32px;border-radius:50%;
  border:1px solid var(--border);background:var(--surface);
  color:var(--muted2);cursor:pointer;font-size:.85rem;
  display:flex;align-items:center;justify-content:center;
  transition:all .15s;flex-shrink:0;
  -webkit-tap-highlight-color:transparent;
}
.modal-close:hover { border-color:var(--gold);color:var(--gold2); }

.modal-body {
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  padding: 16px 18px;
  display: flex;
  flex-direction: column;
  gap: 14px;
}
.terms-section {
  background: var(--surface);
  border-radius: 10px;
  padding: 12px 14px;
  border-left: 3px solid var(--gold);
}
.terms-section-icon { font-size:1rem;margin-bottom:4px; }
.terms-section-title { font-weight:600;font-size:.8rem;color:var(--gold2);margin-bottom:7px; }
.terms-list { padding-left:15px;display:flex;flex-direction:column;gap:5px; }
.terms-list li { font-size:.73rem;color:var(--muted2);line-height:1.55; }
.terms-list li strong { color:var(--text); }

.terms-agreement {
  background:rgba(201,170,80,.07);
  border:1px solid rgba(201,170,80,.2);
  border-radius:10px;
  padding:12px 14px;
  display:flex;flex-direction:column;gap:8px;
}
.terms-agree-label {
  display:flex;align-items:flex-start;gap:10px;
  font-size:.74rem;color:var(--text);cursor:pointer;
}
.terms-agree-label input { margin-top:2px;accent-color:var(--gold); }
.terms-agree-date { font-size:.62rem;color:var(--muted2); }

.modal-footer {
  padding: 12px 18px;
  border-top: 1px solid var(--border);
  display: flex;
  justify-content: flex-end;
  flex-shrink: 0;
}
.modal-btn-close {
  padding:9px 24px;border-radius:20px;
  border:1px solid var(--gold);background:var(--gold-dim);
  color:var(--gold2);font-size:.78rem;font-family:inherit;
  cursor:pointer;transition:all .15s;min-height:40px;
  -webkit-tap-highlight-color:transparent;
}
.modal-btn-close:hover { background:var(--gold);color:#000; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PRINT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@media print {
  body { background:#fff;color:#000; }
  .sidebar,.vtoggle,.nav-btn,.export-btn,.day-dots,
  .trackline-wrap,.modal,.modal-backdrop,.mobile-nav
  { display:none!important; }
  .main { background:#fff;border:none;padding:0; }
  body::before { display:none; }
  .tblock-card { background:#f5f5f5; }
  .wrap { padding:0; }
}
</style>
</head>
<body>

<div class="wrap" id="swipe-area">

  <header>
    <div class="header-arabic">Ø±Ù…Ø¶Ø§Ù† ÙƒØ±ÙŠÙ… Â· Ù…Ø¨Ø§Ø±Ùƒ</div>
    <h1><span class="header-crescent">â˜½</span> Ramadan Study Timetable <span class="header-crescent">â˜½</span></h1>
    <div class="header-meta">5 SUBJECTS Â· 18 ONLINE LECTURES Â· 40 DAYS Â· 7 DAYS/WEEK</div>
    <div class="header-line"></div>
  </header>

  <!-- â”€â”€ PROGRESS TRACKLINE â”€â”€ -->
  <div class="trackline-wrap">
    <div class="trackline-top">
      <div class="trackline-left">
        <span class="tl-label">RAMADAN PROGRESS</span>
        <span class="tl-day-badge" id="tl-day-badge">Day â€”</span>
      </div>
      <div class="trackline-right">
        <span class="tl-pct" id="tl-pct">0%</span>
        <span class="tl-days-left" id="tl-days-left">30 days left</span>
      </div>
    </div>

    <!-- main Ramadan bar -->
    <div class="tl-bar-outer">
      <div class="tl-bar-fill" id="tl-bar-fill"></div>
      <!-- week tick marks -->
      <div class="tl-ticks" id="tl-ticks"></div>
    </div>
    <div class="tl-week-labels" id="tl-week-labels"></div>

    <!-- per-subject mini bars -->
    <div class="tl-subjects" id="tl-subjects"></div>

    <!-- terms link -->
    <div class="tl-footer">
      <button class="tl-terms-btn" onclick="openTerms()">ğŸ“‹ Study Terms & Policies</button>
      <span class="tl-footer-note">Tap any subject bar to log progress</span>
    </div>
  </div>

  <div class="shell">

    <!-- SIDEBAR -->
    <aside class="sidebar">
      <button class="sidebar-toggle" id="sidebar-toggle" onclick="toggleSidebar()">
        <span>ğŸ“‹ Schedule Info & Legend</span>
        <span class="sidebar-toggle-icon">â–¾</span>
      </button>
      <div class="sidebar-content" id="sidebar-content">

      <div>
        <div class="sb-block-title">Subjects</div>
        <div class="subject-list">
          <div class="subj"><span class="subj-dot" style="background:var(--chem-off)"></span><span class="subj-name">Chemistry</span><span class="subj-badge">Offline + Online</span></div>
          <div class="subj"><span class="subj-dot" style="background:var(--phys-on)"></span><span class="subj-name">Physics</span><span class="subj-badge">Online</span></div>
          <div class="subj"><span class="subj-dot" style="background:var(--math)"></span><span class="subj-name">Math</span><span class="subj-badge">Practice</span></div>
          <div class="subj"><span class="subj-dot" style="background:var(--arabic)"></span><span class="subj-name">Arabic</span><span class="subj-badge">Review</span></div>
          <div class="subj"><span class="subj-dot" style="background:var(--english)"></span><span class="subj-name">English</span><span class="subj-badge">Review</span></div>
        </div>
      </div>

      <div>
        <div class="sb-block-title">6-Week Plan (40 Days)</div>
        <div class="week-plan">
          <div class="wplan-row"><span class="wplan-label">Wks 1â€“2</span><span class="wplan-val">Chem Ch3 Â· Phys Ch3</span></div>
          <div class="wplan-row"><span class="wplan-label">Wks 3â€“4</span><span class="wplan-val">Chem Ch4 Â· Phys Ch4</span></div>
          <div class="wplan-row"><span class="wplan-label">Wks 5â€“6</span><span class="wplan-val">Full Revision ğŸ¯</span></div>
          <div class="wplan-row"><span class="wplan-label">Fri Wk1â€“3</span><span class="wplan-val">Physics Online (3 extra)</span></div>
          <div class="wplan-row"><span class="wplan-label">Thu Wk1â€“3</span><span class="wplan-val">Chem Online (3 extra)</span></div>
        </div>
      </div>

      <div>
        <div class="sb-block-title">Online Lecture Tracker</div>
        <div class="tracker">
          <div class="tracker-rows">
            <div class="trow">
              <div class="trow-head"><span>ğŸ§ª Chemistry Online</span><span style="color:var(--chem-on)">9 lecs Â· 45h</span></div>
              <div class="trow-bar"><div class="trow-fill" style="width:40%;background:var(--chem-on)"></div></div>
            </div>
            <div class="trow">
              <div class="trow-head"><span>âš›ï¸ Physics Online</span><span style="color:var(--phys-on)">9 lecs Â· 45h</span></div>
              <div class="trow-bar"><div class="trow-fill" style="width:40%;background:var(--phys-on)"></div></div>
            </div>
            <div class="trow">
              <div class="trow-head"><span style="font-weight:500">ğŸŒ™ Total</span><span style="color:var(--gold2)">18 lecs Â· 90h</span></div>
              <div class="trow-bar"><div class="trow-fill" style="width:40%;background:var(--gold)"></div></div>
            </div>
          </div>
          <div class="tracker-note">
            Chem: Sun every week (6) + Thu Wk1â€“3 (3) = <strong>9 lecs</strong>.<br>
            Physics: Tue every week (6) + Fri Wk1â€“3 (3) = <strong>9 lecs</strong>.<br>
            All 18 done in ~5 weeks Â· Wk6 = full revision.
          </div>
        </div>
      </div>

      <div>
        <div class="sb-block-title">Legend</div>
        <div class="legend">
          <div class="leg"><span class="leg-dot" style="background:var(--chem-off)"></span>Offline Chem</div>
          <div class="leg"><span class="leg-dot" style="background:var(--chem-on)"></span>Chem Online</div>
          <div class="leg"><span class="leg-dot" style="background:var(--phys-on)"></span>Physics Online</div>
          <div class="leg"><span class="leg-dot" style="background:var(--math)"></span>Math Practice</div>
          <div class="leg"><span class="leg-dot" style="background:var(--arabic)"></span>Arabic Review</div>
          <div class="leg"><span class="leg-dot" style="background:var(--english)"></span>English Review</div>
          <div class="leg"><span class="leg-dot" style="background:var(--iftar)"></span>Iftar Break</div>
          <div class="leg"><span class="leg-dot" style="background:var(--hw)"></span>Homework / HW</div>
          <div class="leg"><span class="leg-dot" style="background:var(--rest)"></span>Rest</div>
        </div>
      </div>

      </div><!-- /sidebar-content -->
    </aside>

    <!-- MAIN -->
    <main class="main">

      <div class="vtoggle">
        <button class="vt on" id="btn-week" onclick="switchView('week')">ğŸ“… Week</button>
        <button class="vt" id="btn-day" onclick="switchView('day')">ğŸ“† Day</button>
      </div>

      <!-- WEEK VIEW -->
      <div id="week-view" class="active">
        <div class="week-header">
          <div>
            <div class="week-header-title" id="week-title">Week 1</div>
            <div class="week-header-meta" id="week-date-range"></div>
          </div>
          <div class="week-counter" id="week-counter"></div>
        </div>
        <div class="week-grid-scroll">
          <div class="week-grid" id="week-grid"></div>
        </div>
      </div>

      <!-- DAY VIEW -->
      <div id="day-view">
        <div class="day-nav">
          <button class="nav-btn" onclick="prevDay()">â€¹</button>
          <div class="day-title-wrap">
            <div class="day-main-title" id="day-label"></div>
            <div class="day-subtitle" id="day-sub"></div>
          </div>
          <button class="nav-btn" onclick="nextDay()">â€º</button>
        </div>
        <div class="day-dots" id="daydots"></div>
        <button class="export-btn" onclick="exportPDF()">ğŸ–¨ï¸ Export Day as PDF</button>
        <div class="timeline" id="timeline"></div>
      </div>

    </main>
  </div>
</div><!-- /wrap -->

<!-- â”€â”€ MOBILE BOTTOM NAV â”€â”€ -->
<nav class="mobile-nav">
  <button class="mnav-btn on" id="mnav-week" onclick="switchView('week')">
    <span class="mnav-icon">ğŸ“…</span>Week
  </button>
  <button class="mnav-btn" id="mnav-day" onclick="switchView('day')">
    <span class="mnav-icon">ğŸ“†</span>Day
  </button>
  <button class="mnav-btn" onclick="openTerms()">
    <span class="mnav-icon">ğŸ“‹</span>Rules
  </button>
  <button class="mnav-btn" id="mnav-info" onclick="toggleSidebar()">
    <span class="mnav-icon">â„¹ï¸</span>Info
  </button>
</nav>

<!-- â”€â”€ TERMS & POLICIES MODAL â”€â”€ -->
<div class="modal-backdrop" id="modal-backdrop" onclick="closeTerms()"></div>
<div class="modal" id="terms-modal">
  <div class="modal-header">
    <div class="modal-title-ar">Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ ÙˆØ§Ù„Ø³ÙŠØ§Ø³Ø§Øª</div>
    <h2 class="modal-title">Study Terms & Policies</h2>
    <button class="modal-close" onclick="closeTerms()">âœ•</button>
  </div>
  <div class="modal-body">

    <div class="terms-section">
      <div class="terms-section-icon">â±ï¸</div>
      <div class="terms-section-title">Session Rules</div>
      <ul class="terms-list">
        <li>Every study hour = <strong>45 min focused work + 15 min rest</strong>. No exceptions.</li>
        <li>No phone during study blocks â€” phone goes face-down or in another room.</li>
        <li>Start sessions on time. A 5-minute late start becomes a habit.</li>
        <li>If a session is missed, do <strong>not</strong> double-up the next day. Log it, move on.</li>
      </ul>
    </div>

    <div class="terms-section">
      <div class="terms-section-icon">ğŸŒ™</div>
      <div class="terms-section-title">Ramadan-Specific Policies</div>
      <ul class="terms-list">
        <li>Iftar time (6:00â€“7:30 PM) is sacred â€” <strong>no studying</strong> during this window.</li>
        <li>Suhoor / late-night studying is discouraged â€” sleep is part of the plan.</li>
        <li>Friday evenings and Tarawih time are always free. Faith first.</li>
        <li>Adjust start times by Â±30 min if you feel low-energy. Do not skip entirely.</li>
      </ul>
    </div>

    <div class="terms-section">
      <div class="terms-section-icon">ğŸ“š</div>
      <div class="terms-section-title">Subject Policies</div>
      <ul class="terms-list">
        <li><strong>Chemistry offline</strong>: Always bring textbook + notebook. No passive re-reading â€” solve problems.</li>
        <li><strong>Online lectures (Chem & Physics)</strong>: Watch at 1.25Ã— max. Pause and take notes. Do not binge more than 1 lecture per session.</li>
        <li><strong>Math</strong>: Practice only â€” no re-reading theory without attempting problems first.</li>
        <li><strong>Arabic & English</strong>: Minimum 3 new vocab items per session. Review flashcards for 10 min before starting.</li>
      </ul>
    </div>

    <div class="terms-section">
      <div class="terms-section-icon">ğŸ“ˆ</div>
      <div class="terms-section-title">Progress Tracking Policy</div>
      <ul class="terms-list">
        <li>Mark each lecture / session as âœ… complete in the tracker immediately after finishing.</li>
        <li>Weekly self-review every Thursday evening â€” assess what's behind, adjust Friday rest accordingly.</li>
        <li>Catch-up buffer = 1 extra session per week max. Beyond that, seek help.</li>
        <li>If you fall more than <strong>2 lectures behind</strong>, flag it and revise the plan.</li>
      </ul>
    </div>

    <div class="terms-section">
      <div class="terms-section-icon">ğŸ§ </div>
      <div class="terms-section-title">Wellbeing Rules</div>
      <ul class="terms-list">
        <li>8 hours of sleep is non-negotiable during Ramadan â€” split if needed (night + afternoon).</li>
        <li>Hydrate well between Iftar and Suhoor. Dehydration kills focus.</li>
        <li>If you feel burnt out, take a half-day. It is better than a full breakdown.</li>
        <li>Celebrate small wins â€” every completed session counts. ğŸŒŸ</li>
      </ul>
    </div>

    <div class="terms-agreement">
      <label class="terms-agree-label">
        <input type="checkbox" id="terms-agreed" onchange="saveAgreement()">
        <span>I have read and agree to follow these study terms for Ramadan 1447H</span>
      </label>
      <div class="terms-agree-date" id="terms-agree-date"></div>
    </div>

  </div>
  <div class="modal-footer">
    <button class="modal-btn-close" onclick="closeTerms()">Close</button>
  </div>
</div>

<script>
const DAYS = ["Friday","Saturday","Sunday","Monday","Tuesday","Wednesday","Thursday"];
const DAY_TYPES = [
  "Physics Online Â· Math Â· Arabic Â· English Â· Rest 7â€“11 PM", // Fri (day 0)
  "Offline Chem Â· Math Â· Arabic Â· English",                  // Sat
  "Chem Online Â· Math Â· Arabic Â· English",                   // Sun
  "Offline Chem Â· Math Â· Arabic Â· English",                  // Mon
  "Physics Online Â· Math Â· Arabic Â· English",                // Tue
  "Offline Chem Â· Math Â· English Â· Arabic",                  // Wed
  "Chem Online Â· Physics Review Â· Math",                     // Thu
];

// color keys â†’ CSS vars
const COLORS = {
  "chem-off": "var(--chem-off)",
  "chem-on":  "var(--chem-on)",
  "phys-on":  "var(--phys-on)",
  "math":     "var(--math)",
  "arabic":   "var(--arabic)",
  "english":  "var(--english)",
  "iftar":    "var(--iftar)",
  "rest":     "var(--rest)",
  "sleep":    "var(--sleep)",
  "hw":       "var(--hw)",
};

/*
  FULL 40-DAY PLAN â€” Ramadan 1447H
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Starts: Fri Feb 20, 2026 (Day 1 = index 0)
  Week grid: Fri Feb 20 â†’ Thu Feb 26 = Week 1, etc.
  Ends: ~Thu Apr 2 (Day 42) â€” 6 weeks grid

  Day index order: 0=Fri Â· 1=Sat Â· 2=Sun Â· 3=Mon Â· 4=Tue Â· 5=Wed Â· 6=Thu

  18 online lectures:
    Chem Online  (9): Sun every week (Ã—6) + Thu wk1â€“3 (Ã—3) = 9 âœ“
    Physics Online (9): Tue every week (Ã—6) + Fri wk1â€“3 (Ã—3) = 9 âœ“
  Offline Chem: Sat / Mon / Wed every week
  Arabic + English + Math: every day, all 7 days
  Friday: study 10 AMâ€“7 PM, then REST 7â€“11 PM (4 h protected)
*/

// [ dayIndex, colorKey, title, timeRange, description, ...tags ]
// 0=Fri Â· 1=Sat Â· 2=Sun Â· 3=Mon Â· 4=Tue Â· 5=Wed Â· 6=Thu
const SLOTS = [

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // FRIDAY (0) â€” Day 1 â€” Feb 20
  // Physics Online (Wk1â€“3) then Math/Arabic/Iftar + REST 7â€“11 PM
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  [0,"sleep",   "ğŸ˜´ Wake up",                    "Before 10 AM",        "Morning Â· Jumu'ah preparation"],
  [0,"phys-on", "âš›ï¸ Physics Online Lecture",     "10:00 AM â€“ 3:00 PM",  "Catch-up lecture ~5h Â· pause & take notes", "1 full lecture", "45 min on Â· 15 min off"],
  [0,"hw",      "ğŸ“ Physics Lecture HW",          "3:00 â€“ 4:30 PM",      "Numerical problems from this lecture", "60â€“90 min"],
  [0,"arabic",  "âœï¸ Arabic Study",               "4:30 â€“ 5:15 PM",      "Vocabulary Â· grammar Â· comprehension"],
  [0,"hw",      "ğŸ“ Arabic HW",                  "5:15 â€“ 5:45 PM",      "Written exercises from today's session"],
  [0,"math",    "ğŸ“ Math Practice",              "5:45 â€“ 6:45 PM",      "Problem set Â· mixed chapters", "45 min on Â· 15 min off"],
  [0,"iftar",   "ğŸŒ™ Iftar & Maghrib",            "6:45 â€“ 7:00 PM",      "Iftar Â· Maghrib prayer Â· family time"],
  [0,"rest",    "ğŸ›‹ï¸ REST â€” No Studying",         "7:00 â€“ 11:00 PM",     "Jumu'ah reflection Â· family evening Â· Tarawih Â· recharge", "4 hours Â· protected"],
  [0,"sleep",   "ğŸŒ™ Wind-down",                  "11:00 PM",             "Prepare for Saturday Â· sleep"],

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // SATURDAY (1) â€” Offline Chem day
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  [1,"sleep",   "ğŸ˜´ Wake / Suhoor Rest",         "Before 12 PM",        "Rest after Suhoor Â· gentle start"],
  [1,"chem-off","ğŸ“š Offline Chemistry",          "12:00 â€“ 3:30 PM",     "Ch3/Ch4 textbook & problems Â· teacher notes", "45 min on Â· 15 min off"],
  [1,"hw",      "ğŸ“ Chem HW",                    "3:30 â€“ 5:00 PM",      "Complete all assigned problems from today's session", "90 min max"],
  [1,"arabic",  "âœï¸ Arabic Study",               "5:00 â€“ 5:45 PM",      "Grammar rules Â· reading comprehension Â· vocab list"],
  [1,"hw",      "ğŸ“ Arabic HW",                  "5:45 â€“ 6:00 PM",      "Quick written exercises from today's Arabic session"],
  [1,"iftar",   "ğŸŒ™ Iftar & Maghrib",            "6:00 â€“ 7:30 PM",      "Break Â· prayer Â· family time Â· recharge"],
  [1,"english", "ğŸ“– English Study",              "7:30 â€“ 8:30 PM",      "Reading comprehension Â· grammar Â· writing skills"],
  [1,"hw",      "ğŸ“ English HW",                 "8:30 â€“ 9:15 PM",      "Grammar exercises or short writing task", "45 min"],
  [1,"math",    "ğŸ“ Math Practice",              "9:15 â€“ 10:15 PM",     "Problem sets Â· past paper questions", "45 min on Â· 15 min off"],
  [1,"hw",      "ğŸ“ Math HW",                    "10:15 â€“ 11:00 PM",    "Finish unsolved problems Â· mark errors Â· note weak areas"],
  [1,"sleep",   "ğŸŒ™ Wind-down",                  "11:00 PM",             "Tarawih Â· rest"],

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // SUNDAY (2) â€” Chem Online catch-up
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  [2,"sleep",   "ğŸ˜´ Wake up",                    "Before 10 AM",        "Gentle morning Â· light breakfast"],
  [2,"chem-on", "ğŸ§ª Chem Online Lecture",        "10:00 AM â€“ 3:00 PM",  "Catch-up lecture ~5h Â· pause & take notes", "1 full lecture", "45 min on Â· 15 min off"],
  [2,"hw",      "ğŸ“ Chem Lecture HW",            "3:00 â€“ 4:30 PM",      "Solve all problems released with this lecture", "60â€“90 min"],
  [2,"math",    "ğŸ“ Math Practice",              "4:30 â€“ 5:30 PM",      "Problem-solving session Â· exam-style questions"],
  [2,"hw",      "ğŸ“ Math HW",                    "5:30 â€“ 6:00 PM",      "Finish unsolved math problems from today"],
  [2,"iftar",   "ğŸŒ™ Iftar & Maghrib",            "6:00 â€“ 7:30 PM",      "Break Â· prayer Â· family time Â· recharge"],
  [2,"chem-on", "ğŸ” Chem Lecture Review",        "7:30 â€“ 8:30 PM",      "Re-read notes Â· highlight key equations Â· formula sheet"],
  [2,"hw",      "ğŸ“ Chem Summary Sheet",         "8:30 â€“ 9:30 PM",      "Write one-page summary of today's lecture", "45â€“60 min"],
  [2,"arabic",  "âœï¸ Arabic Study",               "9:30 â€“ 10:15 PM",     "Vocab consolidation Â· grammar drills"],
  [2,"hw",      "ğŸ“ Arabic HW",                  "10:15 â€“ 11:00 PM",    "Written exercises Â· flashcard review"],
  [2,"sleep",   "ğŸŒ™ Wind-down",                  "11:00 PM",             "Tarawih Â· rest"],

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // MONDAY (3) â€” Offline Chem day
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  [3,"sleep",   "ğŸ˜´ Wake / Suhoor Rest",         "Before 12 PM",        "Rest after Suhoor"],
  [3,"chem-off","ğŸ“š Offline Chemistry",          "12:00 â€“ 3:30 PM",     "Ch3/Ch4 Â· new material + review of Saturday", "45 min on Â· 15 min off"],
  [3,"hw",      "ğŸ“ Chem HW",                    "3:30 â€“ 5:00 PM",      "Problem sets from today's offline session", "90 min max"],
  [3,"english", "ğŸ“– English Study",              "5:00 â€“ 5:45 PM",      "Essay writing Â· reading passage Â· vocabulary"],
  [3,"hw",      "ğŸ“ English HW",                 "5:45 â€“ 6:00 PM",      "Grammar task or written answer"],
  [3,"iftar",   "ğŸŒ™ Iftar & Maghrib",            "6:00 â€“ 7:30 PM",      "Break Â· prayer Â· recharge"],
  [3,"arabic",  "âœï¸ Arabic Study",               "7:30 â€“ 8:30 PM",      "Full Arabic session Â· grammar + comprehension + writing"],
  [3,"hw",      "ğŸ“ Arabic HW",                  "8:30 â€“ 9:15 PM",      "Written exercises Â· past paper Arabic questions", "45 min"],
  [3,"math",    "ğŸ“ Math Practice",              "9:15 â€“ 10:15 PM",     "Problem sets Â· focus on weak topics", "45 min on Â· 15 min off"],
  [3,"hw",      "ğŸ“ Math HW",                    "10:15 â€“ 11:00 PM",    "Remaining problems Â· error review"],
  [3,"sleep",   "ğŸŒ™ Wind-down",                  "11:00 PM",             "Tarawih Â· rest"],

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // TUESDAY (4) â€” Physics Online catch-up
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  [4,"sleep",   "ğŸ˜´ Wake up",                    "Before 10 AM",        "Morning routine Â· light breakfast"],
  [4,"phys-on", "âš›ï¸ Physics Online Lecture",     "10:00 AM â€“ 3:00 PM",  "Catch-up lecture ~5h Â· pause & take notes", "1 full lecture", "45 min on Â· 15 min off"],
  [4,"hw",      "ğŸ“ Physics Lecture HW",          "3:00 â€“ 4:30 PM",      "Numerical problems from this lecture", "60â€“90 min"],
  [4,"math",    "ğŸ“ Math Practice",              "4:30 â€“ 5:30 PM",      "Post-lecture problem solving Â· exam style"],
  [4,"hw",      "ğŸ“ Math HW",                    "5:30 â€“ 6:00 PM",      "Finish remaining math questions"],
  [4,"iftar",   "ğŸŒ™ Iftar & Maghrib",            "6:00 â€“ 7:30 PM",      "Break Â· prayer Â· recharge"],
  [4,"phys-on", "ğŸ” Physics Lecture Review",     "7:30 â€“ 8:30 PM",      "Re-read notes Â· diagrams Â· update formula sheet"],
  [4,"hw",      "ğŸ“ Physics Summary Sheet",      "8:30 â€“ 9:30 PM",      "One-page summary + 5 self-test questions", "45â€“60 min"],
  [4,"english", "ğŸ“– English Study",              "9:30 â€“ 10:15 PM",     "Vocabulary Â· comprehension Â· writing"],
  [4,"hw",      "ğŸ“ English HW",                 "10:15 â€“ 11:00 PM",    "Short writing task or grammar drill"],
  [4,"sleep",   "ğŸŒ™ Wind-down",                  "11:00 PM",             "Tarawih Â· rest"],

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // WEDNESDAY (5) â€” Offline Chem day
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  [5,"sleep",   "ğŸ˜´ Wake / Suhoor Rest",         "Before 12 PM",        "Rest after Suhoor"],
  [5,"chem-off","ğŸ“š Offline Chemistry",          "12:00 â€“ 3:30 PM",     "Ch3/Ch4 Â· consolidate Mon material + new content", "45 min on Â· 15 min off"],
  [5,"hw",      "ğŸ“ Chem HW",                    "3:30 â€“ 5:00 PM",      "All assigned problems from today's session", "90 min max"],
  [5,"arabic",  "âœï¸ Arabic Study",               "5:00 â€“ 5:45 PM",      "Comprehension texts Â· grammar Â· essay practice"],
  [5,"hw",      "ğŸ“ Arabic HW",                  "5:45 â€“ 6:00 PM",      "Written task from today's session"],
  [5,"iftar",   "ğŸŒ™ Iftar & Maghrib",            "6:00 â€“ 7:30 PM",      "Break Â· prayer Â· recharge"],
  [5,"english", "ğŸ“– English Study",              "7:30 â€“ 8:30 PM",      "Essay prep Â· vocabulary expansion Â· reading"],
  [5,"hw",      "ğŸ“ English HW",                 "8:30 â€“ 9:15 PM",      "Essay draft or reading comprehension questions", "45 min"],
  [5,"math",    "ğŸ“ Math Practice",              "9:15 â€“ 10:15 PM",     "Problem sets Â· past exam questions", "45 min on Â· 15 min off"],
  [5,"hw",      "ğŸ“ Math HW",                    "10:15 â€“ 11:00 PM",    "Extra problems Â· review all errors made this week"],
  [5,"sleep",   "ğŸŒ™ Wind-down",                  "11:00 PM",             "Tarawih Â· rest"],

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // THURSDAY (6) â€” Chem Online catch-up + weekly wrap
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  [6,"sleep",   "ğŸ˜´ Wake up",                    "Before 10 AM",        "Morning routine"],
  [6,"chem-on", "ğŸ§ª Chem Online Lecture",        "10:00 AM â€“ 3:00 PM",  "Catch-up lecture ~5h Â· notes & pause method", "1 full lecture", "45 min on Â· 15 min off"],
  [6,"hw",      "ğŸ“ Chem Lecture HW",            "3:00 â€“ 4:30 PM",      "All problems & exercises from today's lecture", "60â€“90 min"],
  [6,"math",    "ğŸ“ Math Practice",              "4:30 â€“ 5:30 PM",      "Problem session Â· mixed topics"],
  [6,"hw",      "ğŸ“ Math HW",                    "5:30 â€“ 6:00 PM",      "Remaining math tasks from this session"],
  [6,"iftar",   "ğŸŒ™ Iftar & Maghrib",            "6:00 â€“ 7:30 PM",      "Break Â· prayer Â· recharge"],
  [6,"chem-on", "ğŸ” Chem Review + Weekly Wrap",  "7:30 â€“ 8:30 PM",      "Notes review Â· weak areas Â· prepare weekly summary"],
  [6,"hw",      "ğŸ“ Chem Summary + Self-Test",   "8:30 â€“ 9:30 PM",      "Weekly summary sheet Â· 5 self-test questions per chapter", "45â€“60 min"],
  [6,"english", "ğŸ“– English Study",              "9:30 â€“ 10:15 PM",     "Vocab review Â· reading practice"],
  [6,"hw",      "ğŸ“ English HW",                 "10:15 â€“ 11:00 PM",    "Grammar exercises or short response text"],
  [6,"sleep",   "ğŸŒ™ Wind-down",                  "11:00 PM",             "Tarawih Â· rest"],
];

let currentDay = 0;

// â”€â”€ RAMADAN START DATE â”€â”€
// Ramadan 1447H starts February 20, 2026 (Friday) = Day 1 = index 0
const RAMADAN_START  = new Date(2026, 1, 20);
const SCHEDULE_START = new Date(2026, 1, 20); // plan starts Friday Feb 20

let currentWeek = 0; // 0 = week 1
const TOTAL_WEEKS = 6; // 6 Ã— 7 = 42 days covers the 40-day plan

/*
  LECTURE DISTRIBUTION (18 online lecs total across 40 days):
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Chem Online  (9 lecs):  Sun every week (6) + Thu wk1â€“wk3 (3) = 9 âœ“
  Physics Online (9 lecs): Tue every week (6) + Fri wk1â€“wk3 (3) = 9 âœ“

  Offline Chem: Sat/Mon/Wed every week = 18 offline sessions
  Arabic+English: every day (all 7 days)
  Math: every day (all 7 days)
  Total study days: 40 active days âœ“
*/

// study hours per day (excl. sleep/iftar/4h rest on Fri)
const DAY_HOURS = [9.5, 11.5, 9.5, 11.5, 9.5, 11.5, 7];

function getWeekDates(weekOffset) {
  const dates = [];
  for (let i = 0; i < 7; i++) {
    const d = new Date(SCHEDULE_START);
    d.setDate(SCHEDULE_START.getDate() + weekOffset * 7 + i);
    dates.push(d);
  }
  return dates;
}

function fmt(d) {
  return d.toLocaleDateString('en-GB', { day:'numeric', month:'short' });
}

function ramadanDay(date) {
  // how many days since Ramadan Day 1
  const d = new Date(date); d.setHours(0,0,0,0);
  const r = new Date(RAMADAN_START); r.setHours(0,0,0,0);
  return Math.floor((d - r) / 86400000) + 1;
}

function buildWeekCounter() {
  const el = document.getElementById("week-counter");
  el.innerHTML = Array.from({length: TOTAL_WEEKS}, (_,i) =>
    `<span class="wk-pill ${i===currentWeek?'on':''}" onclick="setWeek(${i})">Wk ${i+1}</span>`
  ).join('');
}

function buildWeekGrid() {
  const dates = getWeekDates(currentWeek);
  const today = new Date();
  today.setHours(0,0,0,0);

  // Update header
  document.getElementById("week-title").textContent = `Week ${currentWeek + 1} of ${TOTAL_WEEKS}`;
  const rd1 = ramadanDay(dates[0]), rd7 = ramadanDay(dates[6]);
  document.getElementById("week-date-range").textContent =
    `${fmt(dates[0])} â€“ ${fmt(dates[6])} Â· Ramadan ${rd1}â€“${rd7}`;

  buildWeekCounter();

  const grid = document.getElementById("week-grid");
  grid.innerHTML = "";

  DAYS.forEach((day, di) => {
    const date = dates[di];
    date.setHours(0,0,0,0);
    const isToday = date.getTime() === today.getTime();
    const daySlots = SLOTS.filter(s => s[0] === di && s[1] !== "sleep");
    const hours = DAY_HOURS[di];

    const monthStr = date.toLocaleDateString('en-GB', {month:'short'}).toUpperCase();
    const dateNum  = date.getDate();

    const html = `
      <div class="wday ${isToday?'today':''}" onclick="goToDay(${di})">
        <div class="wday-header">
          <div class="wday-name">${day}</div>
          ${isToday ? '<span class="wday-today-badge">TODAY</span>' : ''}
        </div>
        <div class="wday-date">${dateNum}</div>
        <div class="wday-month">${monthStr}</div>
        <div class="wday-day-num">Ramadan Day ${ramadanDay(date)}</div>
        <div class="wday-divider"></div>
        <div class="wday-type" style="color:var(--${di===6?'rest':daySlots[0]?.[1]||'muted2'})">${DAY_TYPES[di]}</div>
        <div class="wday-slots">
          ${daySlots.slice(0,5).map(s=>`
            <div class="wslot" style="border-color:${COLORS[s[1]]};color:${COLORS[s[1]]}">
              ${s[2].replace(/[ğŸ§ªâš›ï¸ğŸ“šğŸ“âœï¸ğŸ“–ğŸŒ™ğŸ˜´ğŸ›‹ï¸]/gu,'').trim()}
              <div class="wslot-time">${s[3]}</div>
            </div>
          `).join('')}
        </div>
        <div class="wday-total">
          <span>${daySlots.filter(s=>s[1]!=='iftar'&&s[1]!=='hw'&&s[1]!=='rest').length} sessions</span>
          <span class="wday-total-hours">${di===6 ? '7h study + 4h rest' : hours+'h total'}</span>
        </div>
      </div>`;
    grid.innerHTML += html;
  });
}

function setWeek(w) {
  currentWeek = w;
  buildWeekGrid();
}

function goToDay(di) {
  currentDay = di;
  switchView('day');
}

// â”€â”€ DAY VIEW â”€â”€
function renderDay() {
  document.getElementById("day-label").textContent = DAYS[currentDay];
  document.getElementById("day-sub").textContent   = DAY_TYPES[currentDay];

  // dots
  const dotsEl = document.getElementById("daydots");
  dotsEl.innerHTML = DAYS.map((_,i) =>
    `<span class="daydot ${i===currentDay?'on':''}" onclick="currentDay=${i};renderDay()"></span>`
  ).join('');

  // timeline
  const t = document.getElementById("timeline");
  const slots = SLOTS.filter(s => s[0] === currentDay);
  if (!slots.length) {
    t.innerHTML = `<div class="empty-day">No scheduled sessions Â· Free day ğŸ‰</div>`;
    return;
  }

  t.innerHTML = slots.map((s,i) => {
    const [,colorKey,title,time,desc,...tags] = s;
    const color = COLORS[colorKey];
    return `
    <div class="tblock" style="animation-delay:${i*0.05}s">
      <div class="tblock-time-col">${time.split('â€“')[0].trim()}</div>
      <div class="tblock-connector">
        <span class="tblock-dot" style="border-color:${color};box-shadow:0 0 6px ${color}40;background:${color}22"></span>
        <div class="tblock-line"></div>
      </div>
      <div class="tblock-card ${colorKey==='hw'?'hw-block':''}" style="border-color:${color}">
        <div class="tbc-title">${title}</div>
        <div class="tbc-time">${time}</div>
        ${desc ? `<div class="tbc-desc">${desc}</div>` : ''}
        ${tags.length ? `<div class="tbc-tags">${tags.map(t=>`<span class="tbc-tag">${t}</span>`).join('')}</div>` : ''}
      </div>
    </div>`;
  }).join('');
}

// â”€â”€ NAV â”€â”€
function prevDay() { currentDay = (currentDay + 6) % 7; renderDay(); }
function nextDay() { currentDay = (currentDay + 1) % 7; renderDay(); }

// â”€â”€ SWITCH VIEW â”€â”€
function switchView(v) {
  ['week','day'].forEach(x => {
    document.getElementById(x+'-view').classList.remove('active');
    document.getElementById('btn-'+x).classList.remove('on');
    const mn = document.getElementById('mnav-'+x);
    if(mn) mn.classList.remove('on');
  });
  document.getElementById(v+'-view').classList.add('active');
  document.getElementById('btn-'+v).classList.add('on');
  const mn = document.getElementById('mnav-'+v);
  if(mn) mn.classList.add('on');
  if (v === 'day') renderDay();
  // scroll to top of main on mobile
  const mainEl = document.querySelector('.main');
  if(mainEl && window.innerWidth <= 820) mainEl.scrollIntoView({behavior:'smooth',block:'start'});
}

// â”€â”€ EXPORT â”€â”€
function exportPDF() {
  document.title = DAYS[currentDay] + " â€“ Ramadan Study Plan";
  window.print();
  document.title = "Ramadan Study Timetable";
}

// â”€â”€ SWIPE â”€â”€
let sx = 0;
const area = document.getElementById("swipe-area");
area.addEventListener("touchstart", e => sx = e.touches[0].clientX, {passive:true});
area.addEventListener("touchend", e => {
  const dx = e.changedTouches[0].clientX - sx;
  if (Math.abs(dx) > 60) { dx < 0 ? nextDay() : prevDay(); }
}, {passive:true});

// â”€â”€ PROGRESS TRACKLINE â”€â”€
const RAMADAN_DAYS = 30;

// Subject config: key, label, color, total sessions/lectures
const SUBJECTS = [
  { key: 'chem',    label: 'Chemistry', color: 'var(--chem-off)', total: 18 },
  { key: 'phys',    label: 'Physics',   color: 'var(--phys-on)',  total: 9  },
  { key: 'math',    label: 'Math',      color: 'var(--math)',     total: 24 },
  { key: 'arabic',  label: 'Arabic',    color: 'var(--arabic)',   total: 18 },
  { key: 'english', label: 'English',   color: 'var(--english)',  total: 18 },
];

function loadProgress() {
  try { return JSON.parse(localStorage.getItem('ramadan_progress') || '{}'); } catch(e) { return {}; }
}
function saveProgress(data) {
  try { localStorage.setItem('ramadan_progress', JSON.stringify(data)); } catch(e) {}
}

function buildTrackline() {
  const today = new Date(); today.setHours(0,0,0,0);
  const ramStart = new Date(RAMADAN_START); ramStart.setHours(0,0,0,0);
  const diff = Math.floor((today - ramStart) / 86400000);
  const dayNum  = Math.max(0, Math.min(diff + 1, RAMADAN_DAYS));
  const pct     = Math.round((dayNum / RAMADAN_DAYS) * 100);
  const daysLeft = Math.max(0, RAMADAN_DAYS - dayNum);

  // top row
  document.getElementById('tl-day-badge').textContent = dayNum > 0 ? `Day ${dayNum} of ${RAMADAN_DAYS}` : 'Starts Feb 20';
  document.getElementById('tl-pct').textContent       = pct + '%';
  document.getElementById('tl-days-left').textContent = daysLeft > 0 ? `${daysLeft} days left` : 'Ramadan complete ğŸ‰';

  // fill bar
  document.getElementById('tl-bar-fill').style.width = pct + '%';

  // week tick marks
  const ticksEl = document.getElementById('tl-ticks');
  ticksEl.innerHTML = '';
  for (let w = 1; w < 6; w++) {
    const t = document.createElement('div');
    t.className = 'tl-tick';
    t.style.left = ((w * 7 / RAMADAN_DAYS) * 100) + '%';
    ticksEl.appendChild(t);
  }

  // week labels below bar
  const labelsEl = document.getElementById('tl-week-labels');
  labelsEl.innerHTML = '';
  for (let w = 0; w < 6; w++) {
    const wStart = new Date(SCHEDULE_START);
    wStart.setDate(SCHEDULE_START.getDate() + w * 7);
    const mon = wStart.toLocaleDateString('en-GB', {day:'numeric',month:'short'});
    const span = document.createElement('span');
    span.className = 'tl-wlabel ' + (w === currentWeek ? 'on' : '');
    span.textContent = `Wk${w+1} ${mon}`;
    span.onclick = () => { setWeek(w); switchView('week'); };
    labelsEl.appendChild(span);
  }

  // subject bars
  const progress = loadProgress();
  const subjEl = document.getElementById('tl-subjects');
  subjEl.innerHTML = SUBJECTS.map(s => {
    const done = progress[s.key] || 0;
    const p = Math.round((done / s.total) * 100);
    return `
    <div class="tl-subj" onclick="incrementSubject('${s.key}', ${s.total})" title="Click to log 1 completed session">
      <div class="tl-subj-head">
        <span class="tl-subj-name" style="color:${s.color}">${s.label}</span>
        <span class="tl-subj-pct">${p}%</span>
      </div>
      <div class="tl-subj-bar-outer">
        <div class="tl-subj-bar-fill" style="width:${p}%;background:${s.color}"></div>
      </div>
      <div class="tl-subj-count">
        <span class="tl-subj-done">${done} done</span>
        <span>${s.total} total</span>
      </div>
    </div>`;
  }).join('');
}

function incrementSubject(key, total) {
  const progress = loadProgress();
  const current = progress[key] || 0;
  if (current >= total) {
    if (!confirm(`${key} is already at 100%! Reset to 0?`)) return;
    progress[key] = 0;
  } else {
    progress[key] = current + 1;
  }
  saveProgress(progress);
  buildTrackline();
}

// â”€â”€ TERMS MODAL â”€â”€
function openTerms() {
  document.getElementById('modal-backdrop').classList.add('open');
  document.getElementById('terms-modal').classList.add('open');
  // restore agreement state
  try {
    const agreed = localStorage.getItem('terms_agreed');
    if (agreed) {
      document.getElementById('terms-agreed').checked = true;
      document.getElementById('terms-agree-date').textContent = 'Agreed on ' + agreed;
    }
  } catch(e) {}
}
function closeTerms() {
  document.getElementById('modal-backdrop').classList.remove('open');
  document.getElementById('terms-modal').classList.remove('open');
}
function saveAgreement() {
  const cb = document.getElementById('terms-agreed');
  try {
    if (cb.checked) {
      const d = new Date().toLocaleDateString('en-GB', {day:'numeric',month:'long',year:'numeric'});
      localStorage.setItem('terms_agreed', d);
      document.getElementById('terms-agree-date').textContent = 'Agreed on ' + d;
    } else {
      localStorage.removeItem('terms_agreed');
      document.getElementById('terms-agree-date').textContent = '';
    }
  } catch(e) {}
}

// â”€â”€ SIDEBAR TOGGLE (mobile) â”€â”€
function toggleSidebar() {
  const content = document.getElementById('sidebar-content');
  const btn     = document.getElementById('sidebar-toggle');
  const infoBtn = document.getElementById('mnav-info');
  const isOpen  = content.classList.toggle('open');
  btn.classList.toggle('open', isOpen);
  if(infoBtn) infoBtn.classList.toggle('on', isOpen);
  if(isOpen) {
    // scroll sidebar into view on mobile
    document.querySelector('.sidebar').scrollIntoView({behavior:'smooth',block:'start'});
  }
}

// â”€â”€ INIT â”€â”€
// Auto-set current week based on today vs schedule start
const todayInit = new Date(); todayInit.setHours(0,0,0,0);
const diffDays = Math.floor((todayInit - SCHEDULE_START) / 86400000);
if (diffDays >= 0 && diffDays < TOTAL_WEEKS * 7) {
  currentWeek = Math.floor(diffDays / 7);
}
buildWeekGrid();
buildTrackline();
// dayMap: JS getDay() â†’ our day index (0=Fri,1=Sat,2=Sun,3=Mon,4=Tue,5=Wed,6=Thu)
// JS:  0=Sun,1=Mon,2=Tue,3=Wed,4=Thu,5=Fri,6=Sat
const dayMap = {5:0, 6:1, 0:2, 1:3, 2:4, 3:5, 4:6};
currentDay = dayMap[new Date().getDay()] ?? 0;
</script>
</body>
</html>
